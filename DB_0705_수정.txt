DROP DATABASE IF EXISTS ajaxDB; 
CREATE DATABASE ajaxDB;
USE ajaxDB;

CREATE TABLE `member` (
    id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT
    , regDate DATETIME NOT NULL
    , updateDate DATETIME NOT NULL
    , loginType VARCHAR(20)
    , email VARCHAR(50) UNIQUE
    , loginId VARCHAR(50) UNIQUE
    , loginPw VARCHAR(100)
);

CREATE TABLE memberInfo (
    memberId INT UNSIGNED NOT NULL
    , nickName VARCHAR(50) NOT NULL UNIQUE
);

CREATE TABLE player (
    memberId INT UNSIGNED NOT NULL,
    avatarInfo JSON
);

#이메일 인증코드 발송용
CREATE TABLE email_auth (
    id INT AUTO_INCREMENT PRIMARY KEY,
    email VARCHAR(255) NOT NULL,
    auth_code VARCHAR(20) NOT NULL,
    created_at DATETIME NOT NULL,
    expired_at DATETIME NOT NULL
);


INSERT INTO memberInfo
    SET memberId = 1
        , nickName = '재이';

SELECT mi.*, m.*
    FROM memberInfo mi
    INNER JOIN `member` m
    ON mi.memberId = m.id
    WHERE m.id = 1;
   
SELECT mi.*, m.*
			 FROM memberInfo mi
			 RIGHT JOIN `member` m
			 ON mi.memberId = m.id
			 WHERE loginId = 'asd'
			 
SELECT *
		    FROM player p
		    LEFT JOIN  memberInfo mi
		    ON p.memberId = mi.memberId
		    WHERE memberId = 1


INSERT INTO player (memberId, avatarInfo) VALUES (
    1,
    '{
        "baseModel": "/resource/images/body.glb",
        "parts": {
            "hair": "/resource/images/hair2.glb"
        }
    }'
);

INSERT INTO player (memberId, avatarInfo) VALUES (
    2,
    '{
        "baseModel": "/resource/images/body.glb",
        "parts": {
            "hair": "/resource/images/hair1.glb"
        }
    }'
);

SELECT * FROM `member`;
SELECT * FROM `memberInfo`;
SELECT * FROM player;

TRUNCATE TABLE `member`;
TRUNCATE TABLE memberInfo;
TRUNCATE TABLE player;
